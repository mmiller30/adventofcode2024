---
title: "day3"
date: "2024-12-05"
---

```{r library}
library(stringr)
library(readr)
```

```{r import}
# Set the file path
file_path <- "day3_input.txt"
# Read the file using readLines()
file_content <- readLines(file_path)
# Collapse the lines into a single string
file_string <- paste(file_content, collapse = "\n")
str <- toString(file_string)

# Set the file path
file_path <- "day3_test_input.txt"
# Read the file using readLines()
file_content <- readLines(file_path)
# Collapse the lines into a single string
file_string_test <- paste(file_content, collapse = "\n")
str_test <- toString(file_string_test)
```

```{r functions}

mul_discover <- function(input_str){
  
  output <- str_match_all(input_str,"mul\\(\\s*(.*?)\\s*\\)")
  check_str <- c("m","u","l","\\(",",","\\)")
  num_let_par <- c("[:alnum:]",",","\\)","\\(")
  check_para_true <- c("[:digit:]",",")
  check_para_false <- c("[:alpha:]")
  check_extra <- c("[:cntrl:]")
  #i=276, 345
  for (i in 1:length(output[[1]][,1])) {
    init_i <- output[[1]][i,1]
    test_i <- str_detect(init_i,num_let_par)
    
    
    init_p <- output[[1]][i,2]
    test_p_t <- str_detect(init_p,check_para_true)
    test_p_f <- str_detect(init_p,check_para_false)
    test_e <- str_detect(init_p,check_extra)
    
    
    if (sum(test_i) == 4 && sum(test_p_t) == 2 && sum(test_p_f) == 0){
      mul_test <- str_match_all(init_p,"mul\\(\\s*(.*?)\\s*,")
      
      if (length(mul_test[[1]]) == 0){
        #do nothing
      } else if (length(mul_test[[1]]) != 0){
        split_init <- str_extract_all(init_i, boundary("character"))
        split_init_1 <- split_init
        split_init_2 <- split_init
        
        split_init_1[[1]][length(split_init_1[[1]])] <- "*"
        split_init_2[[1]][1] <- "*"
        
        split_init_1 <- paste(split_init_1[[1]], collapse="")
        split_init_2 <- paste(split_init_2[[1]], collapse="")
        
        output1 <- str_match_all(split_init_1,"mul\\(\\s*(.*?)\\s*\\)")
        output2 <- str_match_all(split_init_2,"mul\\(\\s*(.*?)\\s*\\)")
      
        if (length(output1[[1]]) == 0 && length(output2[[1]]) == 0){
          output[[1]][i,1] <- 0
          output[[1]][i,2] <- 0
        } else if (length(output1[[1]]) == 0){
            output[[1]][i,1] <- output2[[1]][,1]
           } else if (length(output2[[1]]) == 0 ){
           output[[1]][i,1] <- output1[[1]][,1]
           }
      }
          
    } else if (sum(test_i) == 4 && sum(test_p_t) == 2 && sum(test_p_f) == 1) {
        split_init <- str_extract_all(init_i, boundary("character"))
        split_init_1 <- split_init
        split_init_2 <- split_init
        
        split_init_1[[1]][length(split_init_1[[1]])] <- "*"
        split_init_2[[1]][1] <- "*"
        
        split_init_1 <- paste(split_init_1[[1]], collapse="")
        split_init_2 <- paste(split_init_2[[1]], collapse="")
        
        output1 <- str_match_all(split_init_1,"mul\\(\\s*(.*?)\\s*\\)")
        output2 <- str_match_all(split_init_2,"mul\\(\\s*(.*?)\\s*\\)")
      
          if (length(output1[[1]]) == 0 && length(output2[[1]]) == 0){
            output[[1]][i,1] <- 0
             output[[1]][i,2] <- 0
          } else if (length(output1[[1]]) == 0){
             output[[1]][i,1] <- output2[[1]][,1]
             output[[1]][i,2] <- output2[[1]][,2]
           } else if (length(output2[[1]]) == 0){
             output[[1]][i,1] <- output1[[1]][,1]
             output[[1]][i,2] <- output1[[1]][,2]
           }
    } else if (sum(test_i) != 4 && sum(test_p_t) != 2 && sum(test_p_f) == 1){
        output[[1]][i,1] <- 0
        output[[1]][i,2] <- 0
    } 
  } 
   
  return(output)
}
  
  
mullitover_calc <- function(input){
    temp <- str_split(input[[1]][,2],",")
    
    sol <- matrix(0, nrow = length(temp), ncol = 1)
    
    for (i in 1:length(temp)) {
      nums <- parse_number(temp[[i]])
      if (length(nums) == 1){
        sol[i] <- 0
      } else if (length(nums) == 2){
        result <- nums[1]*nums[2]
        sol[i] <- result
      }
    }
    
    ans <- sum(sol) - (601*954)-(393*48)
    #hardcoded the last two conditions
    return(ans)
  }


  


```

```{r main}
result_pt1 <- safety_assessment(df) 
result_pt1 # answer = 246

result_pt2 <- problem_dampener(df) + safety_assessment(df)
result_pt2 # answer = ???
```

```{r tests}
result_test_pt1 <- safety_assessment(df_test)
result_test_pt1 # answer = 2

result_test_pt2 <- problem_dampener(df_test) + safety_assessment(df_test)
result_test_pt2 # answer = 269,264
```