---
title: "day3"
date: "2024-12-05"
---

```{r library}
library(stringr)
library(readr)
library(sjmisc)
```

```{r import}
# Set the file path
file_path <- "day6_input.txt"
# Read the file using readLines()
file_content <- readLines(file_path)

# Set the file path
file_path_test <- "day6_test_input.txt"
# Read the file using readLines()
file_content_test <- readLines(file_path_test)


```

```{r functions}
#Part 1

input_map <- file_content_test

direction <- c("\\^","v","\\>","\\<")
wall <- c("#")
dist_pos <- 1
count <- 0
off_map_flag <- FALSE

find_guard_details <- function(input_map, direction, dist_pos){
  for (i in 1:length(direction)){
    find_guard_y <- str_match_all(input_map,direction[i])
    test <- which(lengths(find_guard_y)!=0)
    
    if (!is_empty(test)){
      y <- which(lengths(find_guard_y)!=0)
      row_y_split <- str_extract_all(input_map[y], boundary("character"))
      find_guard_x <- str_match_all(row_y_split[[1]],direction[i])
      x <- which(lengths(find_guard_x)!=0)
      if ( i == 1){
        dir <- "^" #up
      } else if ( i == 2){
        dir <- "v" #down
      } else if ( i == 3){
        dir <- ">" #right
      } else if ( i == 4){
        dir <- "<" #left
      }
    }
  }
 
 return(list(y_loc = y, x_loc = x, direction = dir, 
             dist_pos = dist_pos))
}

#Motion Up solver
motion_up <- function(guard_details_input, input_map, direction){
  motion <- c("Move","Stop")
  input_map_extract <- str_extract_all(input_map, boundary("character"))
  walls_along_route <- vector(mode = "list", length = guard_details_input$y_loc)
    
  for (i in 1:guard_details_input$y_loc){
    wall_x <- str_match_all(input_map_extract[[i]][guard_details_input$x_loc],wall)
      if (is_empty(wall_x)) {
          walls_along_route[[i]] <- "Move"
      } else if (!is_empty(wall_x)){
          walls_along_route[[i]] <- "Stop"
      }
    }

  find_all_stops <- str_match_all(walls_along_route,"Stop")
  
  if (is_empty(find_all_stops)){
    off_map_flag <- TRUE
    return(list(dist_pos = (guard_details_input$dist_pos+length(find_all_stops)), off_map_flag = off_map_flag))
    break
  } else if (!is_empty(find_all_stops)){
  
    first_stop <- max(which(lengths(find_all_stops)!=0))
    total_moves_up <- guard_details_input$y_loc - 1 - first_stop
    new_y_loc <- guard_details_input$y_loc - total_moves_up
    
    input_map_extract[[guard_details_input$y_loc]][guard_details_input$x_loc] <- "."
    input_map_extract[[new_y_loc]][guard_details_input$x_loc] <- ">"
    
      for (i in 1:length(input_map_extract)){
        input_map[[i]] <- paste(input_map_extract[[i]], collapse="")
      }
    
    return(list(y_loc = new_y_loc, x_loc = guard_details_input$x_loc, dir = ">", 
                input_map = input_map,
                dist_pos = (guard_details_input$dist_pos + total_moves_up),
                off_map_flag <- FALSE))
    }
}

#Motion Right solver
motion_right <- function(guard_details_input, input_map, direction){
  motion <- c("Move","Stop")
  input_map_extract <- str_extract_all(input_map, boundary("character"))
  walls_along_route <- vector(mode = "list", length = guard_details_input$x_loc)
    
  for (i in 1:guard_details_input$x_loc){
    wall_x <- str_match_all(input_map_extract[[guard_details_input$y_loc]][guard_details_input$x_loc+i],wall)
      if (is_empty(wall_x)) {
          walls_along_route[[i]] <- "Move"
      } else if (!is_empty(wall_x)){
          walls_along_route[[i]] <- "Stop"
      }
    }

  find_all_stops <- str_match_all(walls_along_route,"Stop")
  
  if (is_empty(find_all_stops)){
    off_map_flag <- TRUE
    return(list(dist_pos = (guard_details_input$dist_pos+length(find_all_stops)), off_map_flag = off_map_flag))
    break
  } else if (!is_empty(find_all_stops)){
  
    first_stop <- min(which(lengths(find_all_stops)!=0))
    total_moves_right <- first_stop - 1
    new_x_loc <- guard_details_input$x_loc + total_moves_right
    
    input_map_extract[[guard_details_input$y_loc]][guard_details_input$x_loc] <- "."
    input_map_extract[[guard_details_input$y_loc]][new_x_loc] <- "v"
    
      for (i in 1:length(input_map_extract)){
        input_map[[i]] <- paste(input_map_extract[[i]], collapse="")
      }
    
    return(list(y_loc = guard_details_input$y_loc, x_loc = new_x_loc, dir = "v", 
                input_map = input_map,
                dist_pos = (guard_details_input$dist_pos + total_moves_right),
                off_map_flag <- FALSE))
    }
}

#Motion Down solver
motion_down <- function(guard_details_input, input_map, direction){
  motion <- c("Move","Stop")
  input_map_extract <- str_extract_all(input_map, boundary("character"))
  walls_along_route <- vector(mode = "list", length = length(input_map))

  for (i in (guard_details_input$y_loc+1):length(input_map2)){
    wall_x <- str_match_all(input_map_extract[[i]][guard_details_input$x_loc],wall)
      if (is_empty(wall_x)) {
          walls_along_route[[i]] <- "Move"
      } else if (!is_empty(wall_x)){
          walls_along_route[[i]] <- "Stop"
      }
    }

  find_all_stops <- str_match_all(walls_along_route,"Stop")
  
  if (is_empty(find_all_stops)){
    off_map_flag <- TRUE
    return(list(dist_pos = (guard_details_input$dist_pos+length(find_all_stops)), off_map_flag = off_map_flag))
    break
  } else if (!is_empty(find_all_stops)){
  
    first_stop <- min(which(lengths(find_all_stops)!=0))
    total_moves_down <-  first_stop - guard_details_input$y_loc - 1
    new_y_loc <- total_moves_down + guard_details_input$y_loc
    
    input_map_extract[[guard_details_input$y_loc]][guard_details_input$x_loc] <- "."
    input_map_extract[[new_y_loc]][guard_details_input$x_loc] <- "<"
    
      for (i in 1:length(input_map_extract)){
        input_map[[i]] <- paste(input_map_extract[[i]], collapse="")
      }
    
    return(list(y_loc = new_y_loc, x_loc = guard_details_input$x_loc, dir = "<", 
                input_map = input_map,
                dist_pos = (guard_details_input$dist_pos + total_moves_down),
                off_map_flag <- FALSE))
    }
}

#Motion Left solver
motion_left <- function(guard_details_input, input_map, direction){
  motion <- c("Move","Stop")
  input_map_extract <- str_extract_all(input_map, boundary("character"))
  walls_along_route <- vector(mode = "list", length = guard_details_input$x_loc)
    
  for (i in 1:(guard_details_input$x_loc-1)){
    wall_x <- str_match_all(input_map_extract[[guard_details_input$y_loc]][i],wall)
      if (is_empty(wall_x)) {
          walls_along_route[[i]] <- "Move"
      } else if (!is_empty(wall_x)){
          walls_along_route[[i]] <- "Stop"
      }
    }

  find_all_stops <- str_match_all(walls_along_route,"Stop")
  
  if (is_empty(find_all_stops)){
    off_map_flag <- TRUE
    return(list(dist_pos = (guard_details_input$dist_pos+length(find_all_stops)), off_map_flag = off_map_flag))
    break
  } else if (!is_empty(find_all_stops)){
  
    first_stop <- max(which(lengths(find_all_stops)!=0))
    total_moves_left <- guard_details_input$x_loc - first_stop - 1
    new_x_loc <- guard_details_input$x_loc - total_moves_left
    
    input_map_extract[[guard_details_input$y_loc]][guard_details_input$x_loc] <- "."
    input_map_extract[[guard_details_input$y_loc]][new_x_loc] <- "^"
    
      for (i in 1:length(input_map_extract)){
        input_map[[i]] <- paste(input_map_extract[[i]], collapse="")
      }
    
    return(list(y_loc = guard_details_input$y_loc, x_loc = new_x_loc, dir = "^", 
                input_map = input_map,
                dist_pos = (guard_details_input$dist_pos + total_moves_right),
                off_map_flag <- FALSE))
    }
}

start.time <- Sys.time()
while (isFALSE(off_map_flag)){
  guard_details <- find_guard_details(input_map, direction, dist_pos)
  
  if (guard_details$direction == "^"){
    up <- motion_up(guard_details,input_map,direction)
    
    input_map <- up$input_map
    dist_pos <- up$dist_pos
    off_map_flag <- up$off_map_flag
    
  } else if (guard_details$direction == "v"){
    down <- motion_down(guard_details,input_map,direction)
    
    input_map <- down$input_map
    dist_pos <- down$dist_pos
    off_map_flag <- down$off_map_flag
    
  } else if (guard_details$direction == "<"){
    left <- motion_left(guard_details,input_map,directions)
    
    input_map <- left$input_map
    dist_pos <- left$dist_pos
    off_map_flag <- left$off_map_flag
    
  } else if (guard_details$direction == ">"){
    right <- motion_right(guard_details,input_map,direction)
    
    input_map <- right$input_map
    dist_pos <- right$dist_pos
    off_map_flag <- right$off_map_flag
  }
  count <- count + 1
  print(paste("Count",count))
}


pt1_solution <- dist_pos
end.time <- Sys.time()
time.taken <- end.time - start.time
time.taken
```

```{r main}

# Part 2

```
